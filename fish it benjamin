local TweenService = game:GetService("TweenService")
local Player = game.Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- 1. Dasar ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CharlesHub_V2"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false

-- Warna Tema Biru Muda
local MainBlue = Color3.fromRGB(0, 170, 255)
local DarkBlue = Color3.fromRGB(0, 120, 200)
local BgColor = Color3.fromRGB(15, 20, 25)

-- 2. Loading Screen (Animasi Memuat)
local LoadingFrame = Instance.new("Frame")
LoadingFrame.Size = UDim2.new(1, 0, 1, 0)
LoadingFrame.BackgroundColor3 = BgColor
LoadingFrame.ZIndex = 10
LoadingFrame.Parent = ScreenGui

local LoadingText = Instance.new("TextLabel")
LoadingText.Size = UDim2.new(0, 400, 0, 50)
LoadingText.Position = UDim2.new(0.5, -200, 0.5, -25)
LoadingText.BackgroundTransparency = 1
LoadingText.Text = "Charles Hub Memuat ☄️"
LoadingText.TextColor3 = MainBlue
LoadingText.Font = Enum.Font.GothamBold
LoadingText.TextSize = 28
LoadingText.TextTransparency = 1
LoadingText.Parent = LoadingFrame

-- Animasi Teks Memuat (Fade & Bounce)
task.spawn(function()
    TweenService:Create(LoadingText, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    for i = 1, 3 do
        TweenService:Create(LoadingText, TweenInfo.new(0.5), {Position = UDim2.new(0.5, -200, 0.5, -35)}):Play()
        task.wait(0.5)
        TweenService:Create(LoadingText, TweenInfo.new(0.5), {Position = UDim2.new(0.5, -200, 0.5, -25)}):Play()
        task.wait(0.5)
    end
    TweenService:Create(LoadingFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(LoadingText, TweenInfo.new(0.3), {TextTransparency = 1}):Play()
    task.wait(0.5)
    LoadingFrame:Destroy()
end)

-- 3. Main Frame (Menu Utama)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 450, 0, 300)
MainFrame.Position = UDim2.new(0.5, -225, 0.5, -150)
MainFrame.BackgroundColor3 = BgColor
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- Garis Tepi Biru Muda (Border)
local UIGradient = Instance.new("UIStroke")
UIGradient.Thickness = 2
UIGradient.Color = MainBlue
UIGradient.Parent = MainFrame

-- Top Bar
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 45)
TopBar.BackgroundColor3 = Color3.fromRGB(20, 30, 40)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Text = "☄️ Charles Hub"
Title.Size = UDim2.new(0, 200, 1, 0)
Title.Position = UDim2.new(0, 15, 0, 0)
Title.TextColor3 = MainBlue
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.BackgroundTransparency = 1
Title.Parent = TopBar

-- Tombol Close (Animasi Scale)
local CloseBtn = Instance.new("TextButton")
CloseBtn.Text = "X"
CloseBtn.Size = UDim2.new(0, 30, 0, 30)
CloseBtn.Position = UDim2.new(1, -40, 0, 7)
CloseBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Parent = TopBar
Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(0, 8)

-- Tombol Minimize
local MinBtn = Instance.new("TextButton")
MinBtn.Text = "-"
MinBtn.Size = UDim2.new(0, 30, 0, 30)
MinBtn.Position = UDim2.new(1, -75, 0, 7)
MinBtn.BackgroundColor3 = MainBlue
MinBtn.TextColor3 = Color3.new(1,1,1)
MinBtn.Font = Enum.Font.GothamBold
MinBtn.Parent = TopBar
Instance.new("UICorner", MinBtn).CornerRadius = UDim.new(0, 8)

-- 4. Minimize Icon (Charles X Biru Muda)
local MinIcon = Instance.new("TextButton")
MinIcon.Size = UDim2.new(0, 140, 0, 45)
MinIcon.Position = UDim2.new(0, 20, 1, -60)
MinIcon.BackgroundColor3 = BgColor
MinIcon.Text = "☄️ Charles X"
MinIcon.TextColor3 = MainBlue
MinIcon.Font = Enum.Font.GothamBold
MinIcon.TextSize = 16
MinIcon.Visible = false
MinIcon.Parent = ScreenGui

local MinIconStroke = Instance.new("UIStroke")
MinIconStroke.Color = MainBlue
MinIconStroke.Thickness = 2
MinIconStroke.Parent = MinIcon
Instance.new("UICorner", MinIcon).CornerRadius = UDim.new(0, 10)

--- LOGIKA ANIMASI ---

-- Fungsi Close dengan Animasi Mengecil
CloseBtn.MouseButton1Click:Connect(function()
    TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back), {Size = UDim2.new(0,0,0,0), BackgroundTransparency = 1}):Play()
    task.wait(0.4)
    ScreenGui:Destroy()
end)

-- Fungsi Minimize (Meluncur ke pojok)
MinBtn.MouseButton1Click:Connect(function()
    local targetPos = UDim2.new(0, 20, 1, -60)
    TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.In), {Position = targetPos, Size = UDim2.new(0,0,0,0)}):Play()
    task.wait(0.5)
    MainFrame.Visible = false
    MinIcon.Visible = true
    MinIcon.Size = UDim2.new(0,0,0,45)
    TweenService:Create(MinIcon, TweenInfo.new(0.3, Enum.EasingStyle.Back), {Size = UDim2.new(0, 140, 0, 45)}):Play()
end)

-- Fungsi Restore (Buka kembali)
MinIcon.MouseButton1Click:Connect(function()
    TweenService:Create(MinIcon, TweenInfo.new(0.2), {Size = UDim2.new(0,0,0,45)}):Play()
    task.wait(0.2)
    MinIcon.Visible = false
    MainFrame.Visible = true
    MainFrame:TweenPosition(UDim2.new(0.5, -225, 0.5, -150), "Out", "Back", 0.5)
    MainFrame:TweenSize(UDim2.new(0, 450, 0, 300), "Out", "Back", 0.5)
end)

-- Drag System (Bisa digeser)
local dragging, dragInput, dragStart, startPos
TopBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

TopBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)
